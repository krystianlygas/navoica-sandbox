{"version":3,"sources":["webpack:///./lms/static/js/learner_dashboard/unenrollment_factory.js","webpack:///./lms/static/js/learner_dashboard/views/unenroll_view.js","webpack:///external \"jQuery\"?0cb8*********","webpack:///external \"Backbone\"?709d******"],"names":["UnenrollmentFactory","options","UnenrollView","defaults","el","survey","document","querySelector","i","children","length","appendChild","Math","trunc","random","$","hide","removeClass","reason","attr","val","window","analytics","track","category","label","displayName","addClass","text","urls","dashboard","browseCourses","event","xhr","status","isEdx","location","href","switchToSlideOne","click","switchToSlideTwo","bind","signInUser","encodeURIComponent","gettext","stop","css","on","unenrollComplete","Backbone","View"],"mappings":"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","file":"UnenrollmentFactory.js","sourcesContent":["import UnenrollView from './views/unenroll_view';\n\nfunction UnenrollmentFactory(options) {\n  return new UnenrollView(options);\n}\n\nexport { UnenrollmentFactory }; // eslint-disable-line import/prefer-default-export\n\n\n\n// WEBPACK FOOTER //\n// ./lms/static/js/learner_dashboard/unenrollment_factory.js","/* globals gettext */\n\nimport Backbone from 'backbone';\n\nclass UnenrollView extends Backbone.View {\n\n  constructor(options) {\n    const defaults = {\n      el: '.unenroll-modal',\n    };\n    super(Object.assign({}, defaults, options));\n  }\n\n  switchToSlideOne() {\n    // Randomize survey option order\n    const survey = document.querySelector('.options');\n    for (let i = survey.children.length - 1; i >= 0; i -= 1) {\n      survey.appendChild(survey.children[Math.trunc(Math.random() * i)]);\n    }\n    this.$('.inner-wrapper header').hide();\n    this.$('#unenroll_form').hide();\n    this.$('.slide1').removeClass('hidden');\n  }\n\n  switchToSlideTwo() {\n    let reason = this.$(\".reasons_survey input[name='reason']:checked\").attr('val');\n    if (reason === 'Other') {\n      reason = this.$('.other_text').val();\n    }\n    if (reason) {\n      window.analytics.track('unenrollment_reason.selected', {\n        category: 'user-engagement',\n        label: reason,\n        displayName: 'v1',\n      });\n    }\n    this.$('.slide1').addClass('hidden');\n    this.$('.survey_course_name').text(this.$('#unenroll_course_name').text());\n    this.$('.slide2').removeClass('hidden');\n    this.$('.reasons_survey .return_to_dashboard').attr('href', this.urls.dashboard);\n    this.$('.reasons_survey .browse_courses').attr('href', this.urls.browseCourses);\n  }\n\n  unenrollComplete(event, xhr) {\n    if (xhr.status === 200) {\n      if (!this.isEdx) {\n        location.href = this.urls.dashboard;\n      } else {\n        this.switchToSlideOne();\n        this.$('.reasons_survey:first .submit_reasons').click(this.switchToSlideTwo.bind(this));\n      }\n    } else if (xhr.status === 403) {\n      location.href = `${this.urls.signInUser}?course_id=${\n        encodeURIComponent($('#unenroll_course_id').val())}&enrollment_action=unenroll`;\n    } else {\n      $('#unenroll_error').text(\n        gettext('Unable to determine whether we should give you a refund because' +\n                ' of System Error. Please try again later.'),\n      ).stop()\n       .css('display', 'block');\n    }\n  }\n\n  initialize(options) {\n    this.urls = options.urls;\n    this.isEdx = options.isEdx;\n\n    $('#unenroll_form').on('ajax:complete', this.unenrollComplete.bind(this));\n  }\n}\n\nexport default UnenrollView;\n\n\n\n// WEBPACK FOOTER //\n// ./lms/static/js/learner_dashboard/views/unenroll_view.js","(function() { module.exports = window[\"jQuery\"]; }());\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 0\n// module chunks = 4 5 6 9 10 12 13 14 16 17 18 19 20 21 22 23 24 25 26 29","(function() { module.exports = window[\"Backbone\"]; }());\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Backbone\"\n// module id = 1\n// module chunks = 4 5 6 9 10 14 16 17"],"sourceRoot":""}